<HTML>
<HEAD>

<TITLE>Validation de saisies</TITLE>
</HEAD>

<SCRIPT LANGUAGE="JavaScript">

/////////////////////////////////////////////////////////
// Toute adresse e-mail doit contenir un point et le
// caractère "@". Cette fonction recherche ces deux
// caractères. S'ils existent, l'adresse est présumée
// valide. Sinon, l'utilisateur reçoit un message lui
// demandant de recommencer sa saisie.
/////////////////////////////////////////////////////////

function testAdresseEmail(valeur) 
{ var arobace = false
  var point = false
  var positionArobace = -1
  var positionPoint = -1

  // Examiner un à un les caractères de la saisie 
  // et positionner un indicateur lorsqu'un
  // "." et un "@" ont été détectés.
  for (var i=0; i<=valeur.length; i++) 
  { if (valeur.charAt(i) == "@" ) 
    { arobace = true
      positionArobace = i
    }
    else if (valeur.charAt(i) == ".") 
    { point = true
      positionPoint = i
    }
  }

  // Si ces deux caractères ont été trouvés dans le
  // bon ordre (il y a un point après l'arobace) :
  if ((arobace && point) && 
      (positionArobace < positionPoint)) 
  { // L'adresse est correcte.
    alert("Votre adresse e-mail est correcte.")
    return true
  }
  else 
  { // L'adresse e-mail n'est pas correcte
    alert("L'adresse e-mail que vous avez saisie " +
          "est incorrecte\n Recommencez.")
    return false
  }
}

</SCRIPT>

</HEAD>
<BODY>
<H1>Exemple de validation de saisie</H1>
<OL>
<LI>Tapez une adresse e-mail incorrecte (par exemple :
<I>XYZ</I>) dans le champ de saisie ci-dessous et,
ceci fait, cliquez <B>ici</B>.
<P>
<LI>Ensuite, tapez une adresse e-mail correcte 
(par exemple : <I>emily@emilyv.com</I>) dans le 
même champ et cliquez <B>ici</B>.
</OL>
<P>
<FORM>
Adresse e-mail :
<BR>
<INPUT TYPE="text" SIZE="25" NAME="emailAddress" 
       onBlur="testAdresseEmail(this.value)">
</FORM>

</BODY>
</HTML>


